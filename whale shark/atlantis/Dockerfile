FROM --platform=linux/amd64 ghcr.io/runatlantis/atlantis:v0.19.9

ENV GITHUB_USERNAME="solon-the-explorer"

ARG ATLANTIS_TOKEN
ENV ATLANTIS_TOKEN=${ATLANTIS_TOKEN}

ARG ATLANTIS_WEBHOOK_SECRET
ENV ATLANTIS_WEBHOOK_SECRET=${ATLANTIS_WEBHOOK_SECRET}

ARG AWS_ACCESS_KEY_ID
ENV AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}

ARG AWS_SECRET_ACCESS_KEY
ENV AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}

ARG AWS_REGION
ENV AWS_REGION=${AWS_REGION}

ENV REPO_ALLOWLIST="*"

COPY entrypoint.sh /entrypoint.sh 

RUN chmod 755 /entrypoint.sh

EXPOSE 4041

ENTRYPOINT ["/entrypoint.sh"]
